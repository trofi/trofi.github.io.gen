---
title: ghc-7.0.4 is pushed to portage
date: August 6, 2011
---

:PostID: 148
:Title: ghc-7.0.4 is pushed to portage
:Keywords: ghc, gentoo, portage, ia64, arm
:Categories: notes

`15 Июня 2011 года вышел **ghc-7.0.4** <http://www.haskell.org/pipermail/glasgow-haskell-users/2011-June/020494.html>`_.
В оверлее он появился `в тот же день <https://github.com/gentoo-haskell/gentoo-haskell/commit/d5386478a4493d698ee18f40dc52cc6784fdffa1>`_.
Это хорошая традиция.

Подготовка **ghc** к добавлению его в основное дерево **gentoo-x86** заняла почти 2 месяца.
На самом деле это очень быстро :] До этого были (традиционно неюзабельные) релизы **ghc** **7.0.1**,
**7.0.2** и **7.0.3**, основываясь на которых мы уже слали патчи в разные апстримы, которые ломаются с
каждой новой мажорной версией **ghc**. Так что к релизу **7.0.4** у нас всё более-менее собиралось.

В этот раз серьезным изменением было выбрасывание **base-3** и обновление **Cabal** до **1.10**
(появился `новый интерфейс для тестов <http://www.haskell.org/cabal/release/cabal-1.10.1.0/doc/users-guide/#test-suites>`_).

.. raw:: html

   <!--more-->

Основным подстёгивающим фактором быстренько запушить **ghc-7.0.4** в portage явился только-только
вышедший (и уже попавший в оверлей!) релиз-кандидат **ghc-7.2.1**. Судя по всему это уже вторая традиция :]

Как показывает практика до версии **7.2.3** пользоваться им будет нельзя :]

Уже сейчас в ветке **7.2** сломаны:

- **template haskell** (частично починен): `баг #5362 <http://hackage.haskell.org/trac/ghc/ticket/5362>`_
- **unregisterised build** (есть шанс, что починен, проверим в **-rc2**): `баг #5357 <http://hackage.haskell.org/trac/ghc/ticket/5357>`_
- **text** (починен): `баг #5359 <http://hackage.haskell.org/trac/ghc/ticket/5359>`_

И это только проблемы **ghc**, а еще остальные пакеты надо фиксить.

Правда, основные уже подправлены в оверлее и ждут, когда патчи к ним отправятся в **upstream**ы.
Тут даже `написано <https://github.com/gentoo-haskell/gentoo-haskell/blob/master/projects/doc/TODO.rst>`_,
как их (патчи) найти :]

С релизом **ghc-7.0.4** мы потеряли поддержку **ia64**. Бинарник **ghc** настолько велик, что статические
данные переполняют 24-разрядную **gprel** адресацию, а **gcc** для поддержки **-mcmodel=medium** я еще не допилил :[

Но теперь есть кое-какой билд для **arm**! :]
